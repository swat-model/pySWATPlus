
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../data_manager/">
      
      
        <link rel="next" href="../performance_metrics/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>SensitivityAnalyzer - pySWATPlus</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pySWATPlus.SensitivityAnalyzer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pySWATPlus" class="md-header__button md-logo" aria-label="pySWATPlus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pySWATPlus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SensitivityAnalyzer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../userguide/swatplus_simulation/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../txtinout_reader/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../CONTRIBUTING/" class="md-tabs__link">
        
  
  
    
  
  Contributor Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../changelog/" class="md-tabs__link">
        
  
  
    
  
  Release Notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pySWATPlus" class="md-nav__button md-logo" aria-label="pySWATPlus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pySWATPlus
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/swatplus_simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SWAT+ Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/sensitivity_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sensitivity Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../userguide/data_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../txtinout_reader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TxtinoutReader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DataManager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    SensitivityAnalyzer
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    SensitivityAnalyzer
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer" class="md-nav__link">
    <span class="md-ellipsis">
      SensitivityAnalyzer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SensitivityAnalyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample" class="md-nav__link">
    <span class="md-ellipsis">
      simulation_by_sobol_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer.sobol_indices" class="md-nav__link">
    <span class="md-ellipsis">
      sobol_indices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PerformanceMetrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pySWATPlus.types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributor Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer" class="md-nav__link">
    <span class="md-ellipsis">
      SensitivityAnalyzer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SensitivityAnalyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample" class="md-nav__link">
    <span class="md-ellipsis">
      simulation_by_sobol_sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pySWATPlus.SensitivityAnalyzer.sobol_indices" class="md-nav__link">
    <span class="md-ellipsis">
      sobol_indices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>SensitivityAnalyzer</h1>

<div class="doc doc-object doc-class">



<h2 id="pySWATPlus.SensitivityAnalyzer" class="doc doc-heading">
            <code>SensitivityAnalyzer</code>


</h2>


    <div class="doc doc-contents first">


        <p>Provide functionality for sensitivity analyzis.</p>








              <details class="quote">
                <summary>Source code in <code>pySWATPlus/sensitivity_analyzer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SensitivityAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Provide functionality for sensitivity analyzis.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_simulation_data_config</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">simulation_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Validate `simulation_data` configuration.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">valid_subkeys</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;has_units&#39;</span><span class="p">,</span>
            <span class="s1">&#39;begin_date&#39;</span><span class="p">,</span>
            <span class="s1">&#39;end_date&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ref_day&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ref_month&#39;</span><span class="p">,</span>
            <span class="s1">&#39;apply_filter&#39;</span><span class="p">,</span>
            <span class="s1">&#39;usecols&#39;</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">sim_fname</span><span class="p">,</span> <span class="n">sim_fdict</span> <span class="ow">in</span> <span class="n">simulation_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sim_fdict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Expected &quot;</span><span class="si">{</span><span class="n">sim_fname</span><span class="si">}</span><span class="s1">&quot; in simulation_date must be a dictionary, but got type &quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sim_fdict</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;has_units&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim_fdict</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Key has_units is missing for &quot;</span><span class="si">{</span><span class="n">sim_fname</span><span class="si">}</span><span class="s1">&quot; in simulation_data&#39;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">sim_fkey</span> <span class="ow">in</span> <span class="n">sim_fdict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sim_fkey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_subkeys</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Invalid key &quot;</span><span class="si">{</span><span class="n">sim_fkey</span><span class="si">}</span><span class="s1">&quot; for &quot;</span><span class="si">{</span><span class="n">sim_fname</span><span class="si">}</span><span class="s1">&quot; in simulation_data; expected subkeys are </span><span class="si">{</span><span class="n">valid_subkeys</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_sobol_problem</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">params_bounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">BoundDict</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Prepare Sobol problem dictionary for sensitivity analysis.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Count variables</span>
        <span class="n">count_vars</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span>
            <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params_bounds</span>
        <span class="p">)</span>

        <span class="c1"># Intialize dictionary to keeps track the count of variables</span>
        <span class="n">current_count</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">v</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">count_vars</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># List of unique names and bounds of paramters</span>
        <span class="n">var_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">var_bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params_bounds</span><span class="p">:</span>
            <span class="n">p_name</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">count_vars</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Keep same name if occur only once in the list</span>
                <span class="n">var_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Add counter suffix if occur multiple times</span>
                <span class="n">current_count</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_count</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">var_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p_name</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">current_count</span><span class="p">[</span><span class="n">p_name</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">var_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">param</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">])</span>

        <span class="c1"># Sobol problem</span>
        <span class="n">problem</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;num_vars&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">),</span>
            <span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="n">var_names</span><span class="p">,</span>
            <span class="s1">&#39;bounds&#39;</span><span class="p">:</span> <span class="n">var_bounds</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">problem</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cpu_simulation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">track_sim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">var_array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">num_sim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">var_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">simulation_folder</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">txtinout_folder</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">params_bounds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">BoundDict</span><span class="p">],</span>
        <span class="n">simulation_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
        <span class="n">clean_setup</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Execute the simulation on a dedicated logical CPU.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Dictionary mapping for sensitivity simulation name and variable</span>
        <span class="n">var_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">var_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">var_names</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="c1"># Create ParameterType dictionary to write calibration.cal file</span>
        <span class="n">params_sim</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params_bounds</span><span class="p">):</span>
            <span class="n">params_sim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s1">&#39;change_type&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">change_type</span><span class="p">,</span>
                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">var_dict</span><span class="p">[</span><span class="n">var_names</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="p">,</span>
                    <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">conditions</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="c1"># Tracking simulation</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Started simulation: </span><span class="si">{</span><span class="n">track_sim</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">num_sim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">flush</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># Create simulation directory</span>
        <span class="n">cpu_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;sim_</span><span class="si">{</span><span class="n">track_sim</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">cpu_path</span> <span class="o">=</span> <span class="n">simulation_folder</span> <span class="o">/</span> <span class="n">cpu_dir</span>
        <span class="n">cpu_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

        <span class="c1"># Output simulation dictionary</span>
        <span class="n">cpu_output</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dir&#39;</span><span class="p">:</span> <span class="n">cpu_dir</span><span class="p">,</span>
            <span class="s1">&#39;array&#39;</span><span class="p">:</span> <span class="n">var_array</span>
        <span class="p">}</span>

        <span class="c1"># Initialize TxtinoutReader class</span>
        <span class="n">txtinout_reader</span> <span class="o">=</span> <span class="n">TxtinoutReader</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">txtinout_folder</span>
        <span class="p">)</span>

        <span class="c1"># Run SWAT+ model in CPU directory</span>
        <span class="n">txtinout_reader</span><span class="o">.</span><span class="n">run_swat</span><span class="p">(</span>
            <span class="n">target_dir</span><span class="o">=</span><span class="n">cpu_path</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">params_sim</span>
        <span class="p">)</span>

        <span class="c1"># Extract simulated data</span>
        <span class="k">for</span> <span class="n">sim_fname</span><span class="p">,</span> <span class="n">sim_fdict</span> <span class="ow">in</span> <span class="n">simulation_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">target_file</span> <span class="o">=</span> <span class="n">cpu_path</span> <span class="o">/</span> <span class="n">sim_fname</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">DataManager</span><span class="p">()</span><span class="o">.</span><span class="n">simulated_timeseries_df</span><span class="p">(</span>
                <span class="n">target_file</span><span class="o">=</span><span class="n">target_file</span><span class="p">,</span>
                <span class="o">**</span><span class="n">sim_fdict</span>
            <span class="p">)</span>
            <span class="n">cpu_output</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">target_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_df&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>

        <span class="c1"># Remove simulation directory</span>
        <span class="k">if</span> <span class="n">clean_setup</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">cpu_path</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cpu_output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_save_output_in_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">simulation_folder</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">simulation_output</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Write sensitivity simulation outputs to the file `sensitivity_simulation.json`</span>
<span class="sd">        within the `simulation_folder`.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># copy the simulation_output dictionary</span>
        <span class="n">copy_simulation</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">simulation_output</span>
        <span class="p">)</span>

        <span class="c1"># Modify the copied dictionary</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">copy_simulation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Convert &#39;sample&#39; array to list</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
                <span class="n">copy_simulation</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="c1"># Convert datetime.date objects to string in &#39;simulation&#39; dictionary</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;simulation&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">sub_key</span><span class="p">,</span> <span class="n">sub_value</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sub_value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_df&#39;</span><span class="p">):</span>
                            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%Y&#39;</span><span class="p">))</span>
                            <span class="n">copy_simulation</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">sub_key</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="c1"># Path to the JOSN file</span>
        <span class="n">json_file</span> <span class="o">=</span> <span class="n">simulation_folder</span> <span class="o">/</span> <span class="s1">&#39;sensitivity_simulation.json&#39;</span>

        <span class="c1"># Write output to the JSON file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_write</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">copy_simulation</span><span class="p">,</span> <span class="n">output_write</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulation_by_sobol_sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">BoundType</span><span class="p">,</span>
        <span class="n">sample_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">simulation_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">txtinout_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">simulation_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
        <span class="n">max_workers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">save_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">clean_setup</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Provide a high-level interface for performing sensitivity simulations through parallel computing.</span>

<span class="sd">        It uses the method [`SALib.sample.sobol.sample`](https://salib.readthedocs.io/en/latest/api/SALib.sample.html#SALib.sample.sobol.sample),</span>
<span class="sd">        based on [`Sobol sequences`](https://doi.org/10.1016/S0378-4754(00)00270-6), to generate samples from the defined parameter space.</span>

<span class="sd">        For each sample, a dedicated directory is created, and a simulation is executed as a separate process using</span>
<span class="sd">        [`concurrent.futures.ProcessPoolExecutor`](https://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor).</span>
<span class="sd">        Simulations are executed asynchronously, and to ensure computational efficiency, only unique samples are simulated.</span>

<span class="sd">        Each simulation directory is named `sim_&lt;i&gt;`, where `i` ranges from 1 to the number of unique simulations.</span>
<span class="sd">        Simulation results are collected by mapping input samples to their corresponding simulation directories.</span>
<span class="sd">        This mapping is then used to reorder the simulation outputs to match the original input samples.</span>

<span class="sd">        The method returns a detailed dictionary containing time statistics, the problem definition,</span>
<span class="sd">        the sample array, and the simulation results for further analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameters (BoundType): List of dictionaries defining parameter configurations for sensitivity simulations.</span>
<span class="sd">                Each dictionary contain the following keys:</span>

<span class="sd">                - `name` (str): **Required.** Name of the parameter in the `cal_parms.cal` file.</span>
<span class="sd">                - `change_type` (str): **Required.** Type of change to apply. Must be one of &#39;absval&#39;, &#39;abschg&#39;, or &#39;pctchg&#39;.</span>
<span class="sd">                - `lower_bound` (float): **Required.** Lower bound for the parameter.</span>
<span class="sd">                - `upper_bound` (float): **Required.** Upper bound for the parameter.</span>
<span class="sd">                - `units` (Iterable[int]): Optional. List of unit IDs to which the parameter change should be constrained.</span>
<span class="sd">                - `conditions` (dict[str, list[str]]): Optional. Conditions to apply when changing the parameter,</span>
<span class="sd">                  specified as a dictionary mapping condition types to lists of values.</span>

<span class="sd">                Example:</span>
<span class="sd">                    ```python</span>
<span class="sd">                    parameters = [</span>
<span class="sd">                        {</span>
<span class="sd">                            &#39;name&#39;: &#39;cn2&#39;,</span>
<span class="sd">                            &#39;change_type&#39;: &#39;pctchg&#39;,</span>
<span class="sd">                            &#39;lower_bound&#39;: 25,</span>
<span class="sd">                            &#39;upper_bound&#39;: 75,</span>
<span class="sd">                        },</span>
<span class="sd">                        {</span>
<span class="sd">                            &#39;name&#39;: &#39;perco&#39;,</span>
<span class="sd">                            &#39;change_type&#39;: &#39;absval&#39;,</span>
<span class="sd">                            &#39;lower_bound&#39;: 0,</span>
<span class="sd">                            &#39;upper_bound&#39;: 1,</span>
<span class="sd">                            &#39;conditions&#39;: {&#39;hsg&#39;: [&#39;A&#39;]}</span>
<span class="sd">                        },</span>
<span class="sd">                        {</span>
<span class="sd">                            &#39;name&#39;: &#39;bf_max&#39;,</span>
<span class="sd">                            &#39;change_type&#39;: &#39;absval&#39;,</span>
<span class="sd">                            &#39;lower_bound&#39;: 0.1,</span>
<span class="sd">                            &#39;upper_bound&#39;: 2.0,</span>
<span class="sd">                            &#39;units&#39;: range(1, 194)</span>
<span class="sd">                        }</span>
<span class="sd">                    ]</span>
<span class="sd">                    ```</span>

<span class="sd">            sample_number (int): sample_number (int): Determines the number of samples.</span>
<span class="sd">                Generates an array of length `2^N * (D + 1)`, where `D` is the number of parameter changes</span>
<span class="sd">                and `N = sample_number + 1`. For example, when `sample_number` is 1, 12 samples will be generated.</span>

<span class="sd">            simulation_folder (str | pathlib.Path): Path to the folder where individual simulations for each parameter set will be performed.</span>
<span class="sd">                Raises an error if the folder is not empty. This precaution helps prevent data deletion, overwriting directories,</span>
<span class="sd">                and issues with reading required data files not generated by the simulation.</span>

<span class="sd">            txtinout_folder (str | pathlib.Path): Path to the `TxtInOut` folder. Raises an error if the folder does not contain exactly one SWAT+ executable `.exe` file.</span>

<span class="sd">            simulation_data (dict[str, dict[str, typing.Any]]): A nested dictionary specifying how to extract data from SWAT+ simulation output files.</span>
<span class="sd">                The top-level keys are filenames of the output files, without paths (e.g., `channel_sd_day.txt`). Each key must map to a non-empty dictionary</span>
<span class="sd">                containing the following subkeys, as defined in [`simulated_timeseries_df`](https://swat-model.github.io/pySWATPlus/api/data_manager/#pySWATPlus.DataManager.simulated_timeseries_df):</span>

<span class="sd">                - `has_units` (bool): **Required.** If `True`, the third line of the simulated file contains units for the columns.</span>
<span class="sd">                - `begin_date` (str): Optional. Start date in `DD-Mon-YYYY` format (e.g., 01-Jan-2010). Defaults to the earliest date in the simulated file.</span>
<span class="sd">                - `end_date` (str): Optional. End date in `DD-Mon-YYYY` format (e.g., 31-Dec-2013). Defaults to the latest date in the simulated file.</span>
<span class="sd">                - `ref_day` (int): Optional. Reference day for monthly and yearly time series.</span>
<span class="sd">                   If `None` (default), the last day of the month or year is used, obtained from simulation. Not applicable to daily time series files (ending with `_day`).</span>
<span class="sd">                - `ref_month` (int): Optional. Reference month for yearly time series. If `None` (default), the last month of the year is used, obtained from simulation.</span>
<span class="sd">                  Not applicable to monthly time series files (ending with `_mon`).</span>
<span class="sd">                - `apply_filter` (dict[str, list[typing.Any]]): Optional. Each key is a column name and the corresponding value</span>
<span class="sd">                  is a list of allowed values for filtering rows in the DataFrame. By default, no filtering is applied.</span>
<span class="sd">                  An error is raised if filtering produces an empty DataFrame.</span>
<span class="sd">                - `usecols` (list[str]): Optional. List of columns to extract from the simulated file. By default, all available columns are used.</span>

<span class="sd">                ```python</span>
<span class="sd">                simulation_data = {</span>
<span class="sd">                    &#39;channel_sd_mon.txt&#39;: {</span>
<span class="sd">                        &#39;has_units&#39;: True,</span>
<span class="sd">                        &#39;start_date&#39;: &#39;01-Jun-2014&#39;,</span>
<span class="sd">                        &#39;end_date&#39;: &#39;01-Oct-2016&#39;,</span>
<span class="sd">                        &#39;apply_filter&#39;: {&#39;gis_id&#39;: [561], &#39;yr&#39;: [2015, 2016]},</span>
<span class="sd">                        &#39;usecols&#39;: [&#39;gis_id&#39;, &#39;flo_out&#39;]</span>
<span class="sd">                    },</span>
<span class="sd">                    &#39;channel_sd_yr.txt&#39;: {</span>
<span class="sd">                        &#39;has_units&#39;: True,</span>
<span class="sd">                        &#39;apply_filter&#39;: {&#39;name&#39;: [&#39;cha561&#39;], &#39;yr&#39;: [2015, 2016]},</span>
<span class="sd">                        &#39;usecols&#39;: [&#39;gis_id&#39;, &#39;flo_out&#39;]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">                ```</span>

<span class="sd">            max_workers (int): Number of logical CPUs to use for parallel processing. If `None` (default), all available logical CPUs are used.</span>

<span class="sd">            save_output (bool): If `True` (default), saves the output dictionary to `simulation_folder` as `sensitivity_simulation.json`.</span>

<span class="sd">            clean_setup (bool): If `True` (default), each folder created during the parallel simulation and its contents</span>
<span class="sd">                will be deleted dynamically after collecting the required data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary with the follwoing keys:</span>

<span class="sd">                - `time`: A dictionary containing time-related statistics:</span>

<span class="sd">                    - `sample_length`: Total number of samples, including duplicates.</span>
<span class="sd">                    - `total_time_sec`: Total time in seconds for the simulation.</span>
<span class="sd">                    - `time_per_sample_sec`: Average simulation time per sample in seconds.</span>

<span class="sd">                - `problem`: The problem definition dictionary passed to `Sobol` sampling, containing:</span>

<span class="sd">                    - `num_vars`: Total number of variables in `parameters`.</span>
<span class="sd">                    - `names`: Variable names derived from the `name` field of each dictionary in `parameters`. If a parameter appears multiple times</span>
<span class="sd">                      due to different `units` or `conditions`, occurrences are suffixed with a counter (e.g., `perco|1`, `perco|2`).</span>
<span class="sd">                    - `bounds`:  A list of [`lower_bound`, `upper_bound`] pairs corresponding to each dictionary in `parameters`.</span>

<span class="sd">                - `sample`: The sampled array of parameter sets used in the simulations.</span>

<span class="sd">                - `simulation`: Dictionary mapping simulation indices (integers from 1 to `sample_length`) to output sub-dictionaries with the following keys:</span>

<span class="sd">                    - `var`: Dictionary mapping each variable name (from `var_names`) to the actual value used in that simulation.</span>
<span class="sd">                    - `dir`: Name of the directory (e.g., `sim_&lt;i&gt;`) where the simulation was executed. This is useful when `clean_setup` is `False`, as it allows users</span>
<span class="sd">                      to verify whether the sampled values were correctly applied to the target files. The simulation index and directory name (e.g., `sim_&lt;i&gt;`)</span>
<span class="sd">                      may not always match one-to-one due to deduplication or asynchronous execution.</span>
<span class="sd">                    - `&lt;simulation_data_filename&gt;_df`: Filtered `DataFrame` generated for each file specified in the `simulation_data` dictionary</span>
<span class="sd">                      (e.g., `channel_sd_mon_df`, `channel_sd_yr_df`). Each DataFrame includes a `date` column with `datetime.date` objects.</span>

<span class="sd">        Note:</span>
<span class="sd">            - The `problem` dictionary and `sample` array are used later to calculate Sobol indices</span>
<span class="sd">              when comparing performance metrics against observed data.</span>

<span class="sd">            - The integer keys in the `simulation` dictionary may not correspond directly to the</span>
<span class="sd">              simulation directory indices (given by the `dir` key as `sim_&lt;i&gt;`) due to deduplication</span>
<span class="sd">              and asynchronous execution.</span>

<span class="sd">            - The output dictionary contains `datetime.date` objects in the `date` column for each `DataFrame` in the `simulation` dictionary.</span>
<span class="sd">              These `datetime.date` objects are converted to `DD-Mon-YYYY` strings when saving the output dictionary to</span>
<span class="sd">              `sensitivity_simulation.json` within the `simulation_folder`.</span>

<span class="sd">            - The computation progress can be tracked through the following `console` messages, where</span>
<span class="sd">              the simulation index ranges from 1 to the total number of unique simulations:</span>

<span class="sd">                - `Started simulation: &lt;started_index&gt;/&lt;unique_simulations&gt;`</span>
<span class="sd">                - `Completed simulation: &lt;completed_index&gt;/&lt;unique_simulations&gt;`</span>

<span class="sd">            - The disk space on the computer for `simulation_folder` must be sufficient to run</span>
<span class="sd">              parallel simulations (at least `max_workers` times the size of the `TxtInOut` folder).</span>
<span class="sd">              Otherwise, no error will be raised by the system, but simulation outputs may not be generated.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># start time</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Check input variables type</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_variable_origin_static_type</span><span class="p">(</span>
            <span class="n">vars_types</span><span class="o">=</span><span class="n">typing</span><span class="o">.</span><span class="n">get_type_hints</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_by_sobol_sample</span>
            <span class="p">),</span>
            <span class="n">vars_values</span><span class="o">=</span><span class="nb">locals</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># Absolute path</span>
        <span class="n">txtinout_folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">txtinout_folder</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="n">simulation_folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">simulation_folder</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="c1"># Check validity of path</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_path_directory</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">txtinout_folder</span>
        <span class="p">)</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_path_directory</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">simulation_folder</span>
        <span class="p">)</span>

        <span class="c1"># Check simulation_folder is empty</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_empty_directory</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">simulation_folder</span>
        <span class="p">)</span>

        <span class="c1"># Validate simulation_data configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_simulation_data_config</span><span class="p">(</span>
            <span class="n">simulation_data</span><span class="o">=</span><span class="n">simulation_data</span>
        <span class="p">)</span>

        <span class="c1"># Validate unique dictionaries for sensitive parameters</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_list_contain_unique_dict</span><span class="p">(</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
        <span class="p">)</span>

        <span class="c1"># Validate input keys in dictionaries for sensitive parameters</span>
        <span class="n">params_bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">BoundDict</span><span class="p">(</span><span class="o">**</span><span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span>
        <span class="p">]</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_calibration_parameters</span><span class="p">(</span>
            <span class="n">txtinout_path</span><span class="o">=</span><span class="n">txtinout_folder</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">params_bounds</span>
        <span class="p">)</span>

        <span class="c1"># Sobol problem dictionary</span>
        <span class="n">problem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_sobol_problem</span><span class="p">(</span>
            <span class="n">params_bounds</span><span class="o">=</span><span class="n">params_bounds</span>
        <span class="p">)</span>
        <span class="n">copy_problem</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">problem</span>
        <span class="p">)</span>

        <span class="c1"># Generate sample array</span>
        <span class="n">sample_array</span> <span class="o">=</span> <span class="n">SALib</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">sobol</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="n">problem</span><span class="o">=</span><span class="n">copy_problem</span><span class="p">,</span>
            <span class="n">N</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sample_number</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Unique array to avoid duplicate computations</span>
        <span class="n">unique_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
            <span class="n">ar</span><span class="o">=</span><span class="n">sample_array</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>

        <span class="c1"># Number of unique simulations</span>
        <span class="n">num_sim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_array</span><span class="p">)</span>

        <span class="c1"># Sensitivity simulation in separate CPU</span>
        <span class="n">cpu_sim</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cpu_simulation</span><span class="p">,</span>
            <span class="n">num_sim</span><span class="o">=</span><span class="n">num_sim</span><span class="p">,</span>
            <span class="n">var_names</span><span class="o">=</span><span class="n">copy_problem</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">],</span>
            <span class="n">simulation_folder</span><span class="o">=</span><span class="n">simulation_folder</span><span class="p">,</span>
            <span class="n">txtinout_folder</span><span class="o">=</span><span class="n">txtinout_folder</span><span class="p">,</span>
            <span class="n">params_bounds</span><span class="o">=</span><span class="n">params_bounds</span><span class="p">,</span>
            <span class="n">simulation_data</span><span class="o">=</span><span class="n">simulation_data</span><span class="p">,</span>
            <span class="n">clean_setup</span><span class="o">=</span><span class="n">clean_setup</span>
        <span class="p">)</span>

        <span class="c1"># Assign model simulation in individual computer CPU and collect results</span>
        <span class="n">cpu_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="c1"># Multicore simulation</span>
            <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">cpu_sim</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_array</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">future</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="c1"># Message for completion of individual simulation for better tracking</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Completed simulation: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">num_sim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># Collect simulation results</span>
                <span class="n">idx_r</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="n">cpu_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx_r</span><span class="p">[</span><span class="s1">&#39;array&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">idx_r</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;array&#39;</span>
                <span class="p">}</span>

        <span class="c1"># Generate sensitivity simulation output for all sample_array from unique_array outputs</span>
        <span class="n">sim_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_array</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">arr_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">copy_problem</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">],</span> <span class="n">arr</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">sim_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="n">arr_dict</span>
            <span class="p">}</span>
            <span class="c1"># Create a deep copy of the dictionary so changes do not affect other copies</span>
            <span class="n">idx_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">cpu_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">idx_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">sim_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Time statistics</span>
        <span class="n">required_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">time_stats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;sample_length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_array</span><span class="p">),</span>
            <span class="s1">&#39;total_time_sec&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">required_time</span><span class="p">),</span>
            <span class="s1">&#39;time_per_sample_sec&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">required_time</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_array</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># Sensitivity simulaton output</span>
        <span class="n">simulation_output</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time_stats</span><span class="p">,</span>
            <span class="s1">&#39;problem&#39;</span><span class="p">:</span> <span class="n">problem</span><span class="p">,</span>
            <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="n">sample_array</span><span class="p">,</span>
            <span class="s1">&#39;simulation&#39;</span><span class="p">:</span> <span class="n">sim_dict</span>
        <span class="p">}</span>

        <span class="c1"># Write output to the file &#39;sensitivity_simulation_sobol.json&#39; in simulation folder</span>
        <span class="k">if</span> <span class="n">save_output</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_output_in_json</span><span class="p">(</span>
                <span class="n">simulation_folder</span><span class="o">=</span><span class="n">simulation_folder</span><span class="p">,</span>
                <span class="n">simulation_output</span><span class="o">=</span><span class="n">simulation_output</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">simulation_output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sobol_indices</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sim_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">df_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sim_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obs_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obs_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">indicators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">json_file</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compute Sobol sensitivy indices for sample scenarios obtained using</span>
<span class="sd">        the [`simulation_by_sobol_sample`](https://swat-model.github.io/pySWATPlus/api/sensitivity_analyzer/#pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample) method.</span>

<span class="sd">        The method returns a dictionary with two keys:</span>

<span class="sd">        - `problem`: The definition dictionary passed to Sobol sampling.</span>
<span class="sd">        - `sobol_indices`: A dictionary where each key is an indicator name and the corresponding value is the computed Sobol sensitivity indices.</span>

<span class="sd">        Args:</span>
<span class="sd">            sim_file (str | pathlib.Path): Path to the `sensitivity_simulation.json` file produced by `simulation_by_sobol_sample`.</span>

<span class="sd">            df_name (str): Name of the `DataFrame` within `sensitivity_simulation.json` from which to compute scenario indicators.</span>

<span class="sd">            sim_col (str): Name of the column in `df_name` containing simulated values.</span>

<span class="sd">            obs_file (str | pathlib.Path): Path to the CSV file containing observed data. The file must include a</span>
<span class="sd">                `date` column (used to merge simulated and observed data) and use a comma as the separator.</span>

<span class="sd">            date_format (str): Date format of the `date` column in `obs_file`, used to parse `datetime.date` objects from date strings.</span>

<span class="sd">            obs_col (str): Name of the column in `obs_file` containing observed data. All negative and `None` observed values are removed before analysis.</span>

<span class="sd">            indicators (list[str]): List of indicators to compute Sobol indices. Available options:</span>

<span class="sd">                - `NSE`: Nash–Sutcliffe Efficiency</span>
<span class="sd">                - `KGE`: Kling–Gupta Efficiency</span>
<span class="sd">                - `MSE`: Mean Squared Error</span>
<span class="sd">                - `RMSE`: Root Mean Squared Error</span>
<span class="sd">                - `PBIAS`: Percent Bias</span>
<span class="sd">                - `MARE`: Mean Absolute Relative Error</span>

<span class="sd">            json_file (str | pathlib.Path, optional): Path to a JSON file for saving the output dictionary where each key is an indicator name</span>
<span class="sd">                and the corresponding value is the computed Sobol sensitivity indices. If `None` (default), the dictionary is not saved.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary with two keys, `problem` and `sobol_indices`, and their corresponding values.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Check input variables type</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_variable_origin_static_type</span><span class="p">(</span>
            <span class="n">vars_types</span><span class="o">=</span><span class="n">typing</span><span class="o">.</span><span class="n">get_type_hints</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sobol_indices</span>
            <span class="p">),</span>
            <span class="n">vars_values</span><span class="o">=</span><span class="nb">locals</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># Problem and indicators</span>
        <span class="n">prob_inct</span> <span class="o">=</span> <span class="n">PerformanceMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">scenario_indicators</span><span class="p">(</span>
            <span class="n">sim_file</span><span class="o">=</span><span class="n">sim_file</span><span class="p">,</span>
            <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
            <span class="n">sim_col</span><span class="o">=</span><span class="n">sim_col</span><span class="p">,</span>
            <span class="n">obs_file</span><span class="o">=</span><span class="n">obs_file</span><span class="p">,</span>
            <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
            <span class="n">obs_col</span><span class="o">=</span><span class="n">obs_col</span><span class="p">,</span>
            <span class="n">indicators</span><span class="o">=</span><span class="n">indicators</span>
        <span class="p">)</span>
        <span class="n">problem</span> <span class="o">=</span> <span class="n">prob_inct</span><span class="p">[</span><span class="s1">&#39;problem&#39;</span><span class="p">]</span>
        <span class="n">indicator_df</span> <span class="o">=</span> <span class="n">prob_inct</span><span class="p">[</span><span class="s1">&#39;indicator&#39;</span><span class="p">]</span>

        <span class="c1"># Sobol sensitivity indices</span>
        <span class="n">sobol_indices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="p">:</span>
            <span class="c1"># Indicator sensitivity indices</span>
            <span class="n">indicator_sensitivity</span> <span class="o">=</span> <span class="n">SALib</span><span class="o">.</span><span class="n">analyze</span><span class="o">.</span><span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span>
                <span class="n">problem</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">problem</span><span class="p">),</span>
                <span class="n">Y</span><span class="o">=</span><span class="n">indicator_df</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="p">)</span>
            <span class="n">sobol_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator_sensitivity</span>

        <span class="c1"># Save the Sobol indices</span>
        <span class="k">if</span> <span class="n">json_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Raise error for invalid JSON file extension</span>
            <span class="n">json_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="n">validators</span><span class="o">.</span><span class="n">_json_extension</span><span class="p">(</span>
                <span class="n">json_file</span><span class="o">=</span><span class="n">json_file</span>
            <span class="p">)</span>
            <span class="c1"># Modify sensitivity index to write in the JSON file</span>
            <span class="n">copy_indices</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sobol_indices</span><span class="p">)</span>
            <span class="n">write_indices</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="p">:</span>
                <span class="n">write_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">copy_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="c1"># saving output data</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_json</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">write_indices</span><span class="p">,</span> <span class="n">output_json</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="c1"># Output dictionary</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;problem&#39;</span><span class="p">:</span> <span class="n">problem</span><span class="p">,</span>
            <span class="s1">&#39;sobol_indices&#39;</span><span class="p">:</span> <span class="n">sobol_indices</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">simulation_by_sobol_sample</span><span class="p">(</span><span class="n">parameters</span><span class="p">:</span> <span class="n">BoundType</span><span class="p">,</span> <span class="n">sample_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">simulation_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">txtinout_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">simulation_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="n">max_workers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">clean_setup</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Provide a high-level interface for performing sensitivity simulations through parallel computing.</p>
<p>It uses the method <a href="https://salib.readthedocs.io/en/latest/api/SALib.sample.html#SALib.sample.sobol.sample"><code>SALib.sample.sobol.sample</code></a>,
based on <a href="https://doi.org/10.1016/S0378-4754(00)00270-6"><code>Sobol sequences</code></a>, to generate samples from the defined parameter space.</p>
<p>For each sample, a dedicated directory is created, and a simulation is executed as a separate process using
<a href="https://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor"><code>concurrent.futures.ProcessPoolExecutor</code></a>.
Simulations are executed asynchronously, and to ensure computational efficiency, only unique samples are simulated.</p>
<p>Each simulation directory is named <code>sim_&lt;i&gt;</code>, where <code>i</code> ranges from 1 to the number of unique simulations.
Simulation results are collected by mapping input samples to their corresponding simulation directories.
This mapping is then used to reorder the simulation outputs to match the original input samples.</p>
<p>The method returns a detailed dictionary containing time statistics, the problem definition,
the sample array, and the simulation results for further analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="BoundType: typing.TypeAlias = list[dict[str, typing.Any]]

  
      module-attribute
   (pySWATPlus.types.BoundType)" href="../types/#pySWATPlus.types.BoundType">BoundType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dictionaries defining parameter configurations for sensitivity simulations.
Each dictionary contain the following keys:</p>
<ul>
<li><code>name</code> (str): <strong>Required.</strong> Name of the parameter in the <code>cal_parms.cal</code> file.</li>
<li><code>change_type</code> (str): <strong>Required.</strong> Type of change to apply. Must be one of 'absval', 'abschg', or 'pctchg'.</li>
<li><code>lower_bound</code> (float): <strong>Required.</strong> Lower bound for the parameter.</li>
<li><code>upper_bound</code> (float): <strong>Required.</strong> Upper bound for the parameter.</li>
<li><code>units</code> (Iterable[int]): Optional. List of unit IDs to which the parameter change should be constrained.</li>
<li><code>conditions</code> (dict[str, list[str]]): Optional. Conditions to apply when changing the parameter,
  specified as a dictionary mapping condition types to lists of values.</li>
</ul>
<p>Example:
    <div class="highlight"><pre><span></span><code><span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cn2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;change_type&#39;</span><span class="p">:</span> <span class="s1">&#39;pctchg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lower_bound&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
        <span class="s1">&#39;upper_bound&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;perco&#39;</span><span class="p">,</span>
        <span class="s1">&#39;change_type&#39;</span><span class="p">:</span> <span class="s1">&#39;absval&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lower_bound&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;upper_bound&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;conditions&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;hsg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;bf_max&#39;</span><span class="p">,</span>
        <span class="s1">&#39;change_type&#39;</span><span class="p">:</span> <span class="s1">&#39;absval&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lower_bound&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;upper_bound&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">194</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">]</span>
</code></pre></div></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>sample_number (int): Determines the number of samples.
Generates an array of length <code>2^N * (D + 1)</code>, where <code>D</code> is the number of parameter changes
and <code>N = sample_number + 1</code>. For example, when <code>sample_number</code> is 1, 12 samples will be generated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>simulation_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the folder where individual simulations for each parameter set will be performed.
Raises an error if the folder is not empty. This precaution helps prevent data deletion, overwriting directories,
and issues with reading required data files not generated by the simulation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>txtinout_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the <code>TxtInOut</code> folder. Raises an error if the folder does not contain exactly one SWAT+ executable <code>.exe</code> file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>simulation_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A nested dictionary specifying how to extract data from SWAT+ simulation output files.
The top-level keys are filenames of the output files, without paths (e.g., <code>channel_sd_day.txt</code>). Each key must map to a non-empty dictionary
containing the following subkeys, as defined in <a href="https://swat-model.github.io/pySWATPlus/api/data_manager/#pySWATPlus.DataManager.simulated_timeseries_df"><code>simulated_timeseries_df</code></a>:</p>
<ul>
<li><code>has_units</code> (bool): <strong>Required.</strong> If <code>True</code>, the third line of the simulated file contains units for the columns.</li>
<li><code>begin_date</code> (str): Optional. Start date in <code>DD-Mon-YYYY</code> format (e.g., 01-Jan-2010). Defaults to the earliest date in the simulated file.</li>
<li><code>end_date</code> (str): Optional. End date in <code>DD-Mon-YYYY</code> format (e.g., 31-Dec-2013). Defaults to the latest date in the simulated file.</li>
<li><code>ref_day</code> (int): Optional. Reference day for monthly and yearly time series.
   If <code>None</code> (default), the last day of the month or year is used, obtained from simulation. Not applicable to daily time series files (ending with <code>_day</code>).</li>
<li><code>ref_month</code> (int): Optional. Reference month for yearly time series. If <code>None</code> (default), the last month of the year is used, obtained from simulation.
  Not applicable to monthly time series files (ending with <code>_mon</code>).</li>
<li><code>apply_filter</code> (dict[str, list[typing.Any]]): Optional. Each key is a column name and the corresponding value
  is a list of allowed values for filtering rows in the DataFrame. By default, no filtering is applied.
  An error is raised if filtering produces an empty DataFrame.</li>
<li><code>usecols</code> (list[str]): Optional. List of columns to extract from the simulated file. By default, all available columns are used.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">simulation_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;channel_sd_mon.txt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;has_units&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;start_date&#39;</span><span class="p">:</span> <span class="s1">&#39;01-Jun-2014&#39;</span><span class="p">,</span>
        <span class="s1">&#39;end_date&#39;</span><span class="p">:</span> <span class="s1">&#39;01-Oct-2016&#39;</span><span class="p">,</span>
        <span class="s1">&#39;apply_filter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gis_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">561</span><span class="p">],</span> <span class="s1">&#39;yr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">]},</span>
        <span class="s1">&#39;usecols&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gis_id&#39;</span><span class="p">,</span> <span class="s1">&#39;flo_out&#39;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;channel_sd_yr.txt&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;has_units&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;apply_filter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cha561&#39;</span><span class="p">],</span> <span class="s1">&#39;yr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">]},</span>
        <span class="s1">&#39;usecols&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gis_id&#39;</span><span class="p">,</span> <span class="s1">&#39;flo_out&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_workers</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of logical CPUs to use for parallel processing. If <code>None</code> (default), all available logical CPUs are used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_output</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code> (default), saves the output dictionary to <code>simulation_folder</code> as <code>sensitivity_simulation.json</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clean_setup</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code> (default), each folder created during the parallel simulation and its contents
will be deleted dynamically after collecting the required data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with the follwoing keys:</p>
<ul>
<li>
<p><code>time</code>: A dictionary containing time-related statistics:</p>
<ul>
<li><code>sample_length</code>: Total number of samples, including duplicates.</li>
<li><code>total_time_sec</code>: Total time in seconds for the simulation.</li>
<li><code>time_per_sample_sec</code>: Average simulation time per sample in seconds.</li>
</ul>
</li>
<li>
<p><code>problem</code>: The problem definition dictionary passed to <code>Sobol</code> sampling, containing:</p>
<ul>
<li><code>num_vars</code>: Total number of variables in <code>parameters</code>.</li>
<li><code>names</code>: Variable names derived from the <code>name</code> field of each dictionary in <code>parameters</code>. If a parameter appears multiple times
  due to different <code>units</code> or <code>conditions</code>, occurrences are suffixed with a counter (e.g., <code>perco|1</code>, <code>perco|2</code>).</li>
<li><code>bounds</code>:  A list of [<code>lower_bound</code>, <code>upper_bound</code>] pairs corresponding to each dictionary in <code>parameters</code>.</li>
</ul>
</li>
<li>
<p><code>sample</code>: The sampled array of parameter sets used in the simulations.</p>
</li>
<li>
<p><code>simulation</code>: Dictionary mapping simulation indices (integers from 1 to <code>sample_length</code>) to output sub-dictionaries with the following keys:</p>
<ul>
<li><code>var</code>: Dictionary mapping each variable name (from <code>var_names</code>) to the actual value used in that simulation.</li>
<li><code>dir</code>: Name of the directory (e.g., <code>sim_&lt;i&gt;</code>) where the simulation was executed. This is useful when <code>clean_setup</code> is <code>False</code>, as it allows users
  to verify whether the sampled values were correctly applied to the target files. The simulation index and directory name (e.g., <code>sim_&lt;i&gt;</code>)
  may not always match one-to-one due to deduplication or asynchronous execution.</li>
<li><code>&lt;simulation_data_filename&gt;_df</code>: Filtered <code>DataFrame</code> generated for each file specified in the <code>simulation_data</code> dictionary
  (e.g., <code>channel_sd_mon_df</code>, <code>channel_sd_yr_df</code>). Each DataFrame includes a <code>date</code> column with <code>datetime.date</code> objects.</li>
</ul>
</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>
<p>The <code>problem</code> dictionary and <code>sample</code> array are used later to calculate Sobol indices
  when comparing performance metrics against observed data.</p>
</li>
<li>
<p>The integer keys in the <code>simulation</code> dictionary may not correspond directly to the
  simulation directory indices (given by the <code>dir</code> key as <code>sim_&lt;i&gt;</code>) due to deduplication
  and asynchronous execution.</p>
</li>
<li>
<p>The output dictionary contains <code>datetime.date</code> objects in the <code>date</code> column for each <code>DataFrame</code> in the <code>simulation</code> dictionary.
  These <code>datetime.date</code> objects are converted to <code>DD-Mon-YYYY</code> strings when saving the output dictionary to
  <code>sensitivity_simulation.json</code> within the <code>simulation_folder</code>.</p>
</li>
<li>
<p>The computation progress can be tracked through the following <code>console</code> messages, where
  the simulation index ranges from 1 to the total number of unique simulations:</p>
<ul>
<li><code>Started simulation: &lt;started_index&gt;/&lt;unique_simulations&gt;</code></li>
<li><code>Completed simulation: &lt;completed_index&gt;/&lt;unique_simulations&gt;</code></li>
</ul>
</li>
<li>
<p>The disk space on the computer for <code>simulation_folder</code> must be sufficient to run
  parallel simulations (at least <code>max_workers</code> times the size of the <code>TxtInOut</code> folder).
  Otherwise, no error will be raised by the system, but simulation outputs may not be generated.</p>
</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>pySWATPlus/sensitivity_analyzer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simulation_by_sobol_sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">BoundType</span><span class="p">,</span>
    <span class="n">sample_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">simulation_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">txtinout_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">simulation_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">save_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">clean_setup</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Provide a high-level interface for performing sensitivity simulations through parallel computing.</span>

<span class="sd">    It uses the method [`SALib.sample.sobol.sample`](https://salib.readthedocs.io/en/latest/api/SALib.sample.html#SALib.sample.sobol.sample),</span>
<span class="sd">    based on [`Sobol sequences`](https://doi.org/10.1016/S0378-4754(00)00270-6), to generate samples from the defined parameter space.</span>

<span class="sd">    For each sample, a dedicated directory is created, and a simulation is executed as a separate process using</span>
<span class="sd">    [`concurrent.futures.ProcessPoolExecutor`](https://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor).</span>
<span class="sd">    Simulations are executed asynchronously, and to ensure computational efficiency, only unique samples are simulated.</span>

<span class="sd">    Each simulation directory is named `sim_&lt;i&gt;`, where `i` ranges from 1 to the number of unique simulations.</span>
<span class="sd">    Simulation results are collected by mapping input samples to their corresponding simulation directories.</span>
<span class="sd">    This mapping is then used to reorder the simulation outputs to match the original input samples.</span>

<span class="sd">    The method returns a detailed dictionary containing time statistics, the problem definition,</span>
<span class="sd">    the sample array, and the simulation results for further analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters (BoundType): List of dictionaries defining parameter configurations for sensitivity simulations.</span>
<span class="sd">            Each dictionary contain the following keys:</span>

<span class="sd">            - `name` (str): **Required.** Name of the parameter in the `cal_parms.cal` file.</span>
<span class="sd">            - `change_type` (str): **Required.** Type of change to apply. Must be one of &#39;absval&#39;, &#39;abschg&#39;, or &#39;pctchg&#39;.</span>
<span class="sd">            - `lower_bound` (float): **Required.** Lower bound for the parameter.</span>
<span class="sd">            - `upper_bound` (float): **Required.** Upper bound for the parameter.</span>
<span class="sd">            - `units` (Iterable[int]): Optional. List of unit IDs to which the parameter change should be constrained.</span>
<span class="sd">            - `conditions` (dict[str, list[str]]): Optional. Conditions to apply when changing the parameter,</span>
<span class="sd">              specified as a dictionary mapping condition types to lists of values.</span>

<span class="sd">            Example:</span>
<span class="sd">                ```python</span>
<span class="sd">                parameters = [</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;name&#39;: &#39;cn2&#39;,</span>
<span class="sd">                        &#39;change_type&#39;: &#39;pctchg&#39;,</span>
<span class="sd">                        &#39;lower_bound&#39;: 25,</span>
<span class="sd">                        &#39;upper_bound&#39;: 75,</span>
<span class="sd">                    },</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;name&#39;: &#39;perco&#39;,</span>
<span class="sd">                        &#39;change_type&#39;: &#39;absval&#39;,</span>
<span class="sd">                        &#39;lower_bound&#39;: 0,</span>
<span class="sd">                        &#39;upper_bound&#39;: 1,</span>
<span class="sd">                        &#39;conditions&#39;: {&#39;hsg&#39;: [&#39;A&#39;]}</span>
<span class="sd">                    },</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;name&#39;: &#39;bf_max&#39;,</span>
<span class="sd">                        &#39;change_type&#39;: &#39;absval&#39;,</span>
<span class="sd">                        &#39;lower_bound&#39;: 0.1,</span>
<span class="sd">                        &#39;upper_bound&#39;: 2.0,</span>
<span class="sd">                        &#39;units&#39;: range(1, 194)</span>
<span class="sd">                    }</span>
<span class="sd">                ]</span>
<span class="sd">                ```</span>

<span class="sd">        sample_number (int): sample_number (int): Determines the number of samples.</span>
<span class="sd">            Generates an array of length `2^N * (D + 1)`, where `D` is the number of parameter changes</span>
<span class="sd">            and `N = sample_number + 1`. For example, when `sample_number` is 1, 12 samples will be generated.</span>

<span class="sd">        simulation_folder (str | pathlib.Path): Path to the folder where individual simulations for each parameter set will be performed.</span>
<span class="sd">            Raises an error if the folder is not empty. This precaution helps prevent data deletion, overwriting directories,</span>
<span class="sd">            and issues with reading required data files not generated by the simulation.</span>

<span class="sd">        txtinout_folder (str | pathlib.Path): Path to the `TxtInOut` folder. Raises an error if the folder does not contain exactly one SWAT+ executable `.exe` file.</span>

<span class="sd">        simulation_data (dict[str, dict[str, typing.Any]]): A nested dictionary specifying how to extract data from SWAT+ simulation output files.</span>
<span class="sd">            The top-level keys are filenames of the output files, without paths (e.g., `channel_sd_day.txt`). Each key must map to a non-empty dictionary</span>
<span class="sd">            containing the following subkeys, as defined in [`simulated_timeseries_df`](https://swat-model.github.io/pySWATPlus/api/data_manager/#pySWATPlus.DataManager.simulated_timeseries_df):</span>

<span class="sd">            - `has_units` (bool): **Required.** If `True`, the third line of the simulated file contains units for the columns.</span>
<span class="sd">            - `begin_date` (str): Optional. Start date in `DD-Mon-YYYY` format (e.g., 01-Jan-2010). Defaults to the earliest date in the simulated file.</span>
<span class="sd">            - `end_date` (str): Optional. End date in `DD-Mon-YYYY` format (e.g., 31-Dec-2013). Defaults to the latest date in the simulated file.</span>
<span class="sd">            - `ref_day` (int): Optional. Reference day for monthly and yearly time series.</span>
<span class="sd">               If `None` (default), the last day of the month or year is used, obtained from simulation. Not applicable to daily time series files (ending with `_day`).</span>
<span class="sd">            - `ref_month` (int): Optional. Reference month for yearly time series. If `None` (default), the last month of the year is used, obtained from simulation.</span>
<span class="sd">              Not applicable to monthly time series files (ending with `_mon`).</span>
<span class="sd">            - `apply_filter` (dict[str, list[typing.Any]]): Optional. Each key is a column name and the corresponding value</span>
<span class="sd">              is a list of allowed values for filtering rows in the DataFrame. By default, no filtering is applied.</span>
<span class="sd">              An error is raised if filtering produces an empty DataFrame.</span>
<span class="sd">            - `usecols` (list[str]): Optional. List of columns to extract from the simulated file. By default, all available columns are used.</span>

<span class="sd">            ```python</span>
<span class="sd">            simulation_data = {</span>
<span class="sd">                &#39;channel_sd_mon.txt&#39;: {</span>
<span class="sd">                    &#39;has_units&#39;: True,</span>
<span class="sd">                    &#39;start_date&#39;: &#39;01-Jun-2014&#39;,</span>
<span class="sd">                    &#39;end_date&#39;: &#39;01-Oct-2016&#39;,</span>
<span class="sd">                    &#39;apply_filter&#39;: {&#39;gis_id&#39;: [561], &#39;yr&#39;: [2015, 2016]},</span>
<span class="sd">                    &#39;usecols&#39;: [&#39;gis_id&#39;, &#39;flo_out&#39;]</span>
<span class="sd">                },</span>
<span class="sd">                &#39;channel_sd_yr.txt&#39;: {</span>
<span class="sd">                    &#39;has_units&#39;: True,</span>
<span class="sd">                    &#39;apply_filter&#39;: {&#39;name&#39;: [&#39;cha561&#39;], &#39;yr&#39;: [2015, 2016]},</span>
<span class="sd">                    &#39;usecols&#39;: [&#39;gis_id&#39;, &#39;flo_out&#39;]</span>
<span class="sd">                }</span>
<span class="sd">            }</span>
<span class="sd">            ```</span>

<span class="sd">        max_workers (int): Number of logical CPUs to use for parallel processing. If `None` (default), all available logical CPUs are used.</span>

<span class="sd">        save_output (bool): If `True` (default), saves the output dictionary to `simulation_folder` as `sensitivity_simulation.json`.</span>

<span class="sd">        clean_setup (bool): If `True` (default), each folder created during the parallel simulation and its contents</span>
<span class="sd">            will be deleted dynamically after collecting the required data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with the follwoing keys:</span>

<span class="sd">            - `time`: A dictionary containing time-related statistics:</span>

<span class="sd">                - `sample_length`: Total number of samples, including duplicates.</span>
<span class="sd">                - `total_time_sec`: Total time in seconds for the simulation.</span>
<span class="sd">                - `time_per_sample_sec`: Average simulation time per sample in seconds.</span>

<span class="sd">            - `problem`: The problem definition dictionary passed to `Sobol` sampling, containing:</span>

<span class="sd">                - `num_vars`: Total number of variables in `parameters`.</span>
<span class="sd">                - `names`: Variable names derived from the `name` field of each dictionary in `parameters`. If a parameter appears multiple times</span>
<span class="sd">                  due to different `units` or `conditions`, occurrences are suffixed with a counter (e.g., `perco|1`, `perco|2`).</span>
<span class="sd">                - `bounds`:  A list of [`lower_bound`, `upper_bound`] pairs corresponding to each dictionary in `parameters`.</span>

<span class="sd">            - `sample`: The sampled array of parameter sets used in the simulations.</span>

<span class="sd">            - `simulation`: Dictionary mapping simulation indices (integers from 1 to `sample_length`) to output sub-dictionaries with the following keys:</span>

<span class="sd">                - `var`: Dictionary mapping each variable name (from `var_names`) to the actual value used in that simulation.</span>
<span class="sd">                - `dir`: Name of the directory (e.g., `sim_&lt;i&gt;`) where the simulation was executed. This is useful when `clean_setup` is `False`, as it allows users</span>
<span class="sd">                  to verify whether the sampled values were correctly applied to the target files. The simulation index and directory name (e.g., `sim_&lt;i&gt;`)</span>
<span class="sd">                  may not always match one-to-one due to deduplication or asynchronous execution.</span>
<span class="sd">                - `&lt;simulation_data_filename&gt;_df`: Filtered `DataFrame` generated for each file specified in the `simulation_data` dictionary</span>
<span class="sd">                  (e.g., `channel_sd_mon_df`, `channel_sd_yr_df`). Each DataFrame includes a `date` column with `datetime.date` objects.</span>

<span class="sd">    Note:</span>
<span class="sd">        - The `problem` dictionary and `sample` array are used later to calculate Sobol indices</span>
<span class="sd">          when comparing performance metrics against observed data.</span>

<span class="sd">        - The integer keys in the `simulation` dictionary may not correspond directly to the</span>
<span class="sd">          simulation directory indices (given by the `dir` key as `sim_&lt;i&gt;`) due to deduplication</span>
<span class="sd">          and asynchronous execution.</span>

<span class="sd">        - The output dictionary contains `datetime.date` objects in the `date` column for each `DataFrame` in the `simulation` dictionary.</span>
<span class="sd">          These `datetime.date` objects are converted to `DD-Mon-YYYY` strings when saving the output dictionary to</span>
<span class="sd">          `sensitivity_simulation.json` within the `simulation_folder`.</span>

<span class="sd">        - The computation progress can be tracked through the following `console` messages, where</span>
<span class="sd">          the simulation index ranges from 1 to the total number of unique simulations:</span>

<span class="sd">            - `Started simulation: &lt;started_index&gt;/&lt;unique_simulations&gt;`</span>
<span class="sd">            - `Completed simulation: &lt;completed_index&gt;/&lt;unique_simulations&gt;`</span>

<span class="sd">        - The disk space on the computer for `simulation_folder` must be sufficient to run</span>
<span class="sd">          parallel simulations (at least `max_workers` times the size of the `TxtInOut` folder).</span>
<span class="sd">          Otherwise, no error will be raised by the system, but simulation outputs may not be generated.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># start time</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Check input variables type</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_variable_origin_static_type</span><span class="p">(</span>
        <span class="n">vars_types</span><span class="o">=</span><span class="n">typing</span><span class="o">.</span><span class="n">get_type_hints</span><span class="p">(</span>
            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">simulation_by_sobol_sample</span>
        <span class="p">),</span>
        <span class="n">vars_values</span><span class="o">=</span><span class="nb">locals</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># Absolute path</span>
    <span class="n">txtinout_folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">txtinout_folder</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="n">simulation_folder</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">simulation_folder</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="c1"># Check validity of path</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_path_directory</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">txtinout_folder</span>
    <span class="p">)</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_path_directory</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">simulation_folder</span>
    <span class="p">)</span>

    <span class="c1"># Check simulation_folder is empty</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_empty_directory</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">simulation_folder</span>
    <span class="p">)</span>

    <span class="c1"># Validate simulation_data configuration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_simulation_data_config</span><span class="p">(</span>
        <span class="n">simulation_data</span><span class="o">=</span><span class="n">simulation_data</span>
    <span class="p">)</span>

    <span class="c1"># Validate unique dictionaries for sensitive parameters</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_list_contain_unique_dict</span><span class="p">(</span>
        <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
    <span class="p">)</span>

    <span class="c1"># Validate input keys in dictionaries for sensitive parameters</span>
    <span class="n">params_bounds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">BoundDict</span><span class="p">(</span><span class="o">**</span><span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span>
    <span class="p">]</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_calibration_parameters</span><span class="p">(</span>
        <span class="n">txtinout_path</span><span class="o">=</span><span class="n">txtinout_folder</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="n">params_bounds</span>
    <span class="p">)</span>

    <span class="c1"># Sobol problem dictionary</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_sobol_problem</span><span class="p">(</span>
        <span class="n">params_bounds</span><span class="o">=</span><span class="n">params_bounds</span>
    <span class="p">)</span>
    <span class="n">copy_problem</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">problem</span>
    <span class="p">)</span>

    <span class="c1"># Generate sample array</span>
    <span class="n">sample_array</span> <span class="o">=</span> <span class="n">SALib</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">sobol</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">problem</span><span class="o">=</span><span class="n">copy_problem</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sample_number</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Unique array to avoid duplicate computations</span>
    <span class="n">unique_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
        <span class="n">ar</span><span class="o">=</span><span class="n">sample_array</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="c1"># Number of unique simulations</span>
    <span class="n">num_sim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_array</span><span class="p">)</span>

    <span class="c1"># Sensitivity simulation in separate CPU</span>
    <span class="n">cpu_sim</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cpu_simulation</span><span class="p">,</span>
        <span class="n">num_sim</span><span class="o">=</span><span class="n">num_sim</span><span class="p">,</span>
        <span class="n">var_names</span><span class="o">=</span><span class="n">copy_problem</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">],</span>
        <span class="n">simulation_folder</span><span class="o">=</span><span class="n">simulation_folder</span><span class="p">,</span>
        <span class="n">txtinout_folder</span><span class="o">=</span><span class="n">txtinout_folder</span><span class="p">,</span>
        <span class="n">params_bounds</span><span class="o">=</span><span class="n">params_bounds</span><span class="p">,</span>
        <span class="n">simulation_data</span><span class="o">=</span><span class="n">simulation_data</span><span class="p">,</span>
        <span class="n">clean_setup</span><span class="o">=</span><span class="n">clean_setup</span>
    <span class="p">)</span>

    <span class="c1"># Assign model simulation in individual computer CPU and collect results</span>
    <span class="n">cpu_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="c1"># Multicore simulation</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">cpu_sim</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_array</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">future</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Message for completion of individual simulation for better tracking</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Completed simulation: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">num_sim</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Collect simulation results</span>
            <span class="n">idx_r</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="n">cpu_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx_r</span><span class="p">[</span><span class="s1">&#39;array&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">idx_r</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;array&#39;</span>
            <span class="p">}</span>

    <span class="c1"># Generate sensitivity simulation output for all sample_array from unique_array outputs</span>
    <span class="n">sim_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_array</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">arr_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">copy_problem</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">],</span> <span class="n">arr</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">sim_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="n">arr_dict</span>
        <span class="p">}</span>
        <span class="c1"># Create a deep copy of the dictionary so changes do not affect other copies</span>
        <span class="n">idx_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">cpu_dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">arr</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">idx_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sim_dict</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="c1"># Time statistics</span>
    <span class="n">required_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">time_stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;sample_length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_array</span><span class="p">),</span>
        <span class="s1">&#39;total_time_sec&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">required_time</span><span class="p">),</span>
        <span class="s1">&#39;time_per_sample_sec&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">required_time</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_array</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1"># Sensitivity simulaton output</span>
    <span class="n">simulation_output</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time_stats</span><span class="p">,</span>
        <span class="s1">&#39;problem&#39;</span><span class="p">:</span> <span class="n">problem</span><span class="p">,</span>
        <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="n">sample_array</span><span class="p">,</span>
        <span class="s1">&#39;simulation&#39;</span><span class="p">:</span> <span class="n">sim_dict</span>
    <span class="p">}</span>

    <span class="c1"># Write output to the file &#39;sensitivity_simulation_sobol.json&#39; in simulation folder</span>
    <span class="k">if</span> <span class="n">save_output</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_output_in_json</span><span class="p">(</span>
            <span class="n">simulation_folder</span><span class="o">=</span><span class="n">simulation_folder</span><span class="p">,</span>
            <span class="n">simulation_output</span><span class="o">=</span><span class="n">simulation_output</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">simulation_output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pySWATPlus.SensitivityAnalyzer.sobol_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sobol_indices</span><span class="p">(</span><span class="n">sim_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">df_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sim_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obs_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obs_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indicators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">json_file</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute Sobol sensitivy indices for sample scenarios obtained using
the <a href="https://swat-model.github.io/pySWATPlus/api/sensitivity_analyzer/#pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample"><code>simulation_by_sobol_sample</code></a> method.</p>
<p>The method returns a dictionary with two keys:</p>
<ul>
<li><code>problem</code>: The definition dictionary passed to Sobol sampling.</li>
<li><code>sobol_indices</code>: A dictionary where each key is an indicator name and the corresponding value is the computed Sobol sensitivity indices.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sim_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the <code>sensitivity_simulation.json</code> file produced by <code>simulation_by_sobol_sample</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the <code>DataFrame</code> within <code>sensitivity_simulation.json</code> from which to compute scenario indicators.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sim_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column in <code>df_name</code> containing simulated values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the CSV file containing observed data. The file must include a
<code>date</code> column (used to merge simulated and observed data) and use a comma as the separator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date format of the <code>date</code> column in <code>obs_file</code>, used to parse <code>datetime.date</code> objects from date strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column in <code>obs_file</code> containing observed data. All negative and <code>None</code> observed values are removed before analysis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indicators</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of indicators to compute Sobol indices. Available options:</p>
<ul>
<li><code>NSE</code>: Nash–Sutcliffe Efficiency</li>
<li><code>KGE</code>: Kling–Gupta Efficiency</li>
<li><code>MSE</code>: Mean Squared Error</li>
<li><code>RMSE</code>: Root Mean Squared Error</li>
<li><code>PBIAS</code>: Percent Bias</li>
<li><code>MARE</code>: Mean Absolute Relative Error</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>json_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a JSON file for saving the output dictionary where each key is an indicator name
and the corresponding value is the computed Sobol sensitivity indices. If <code>None</code> (default), the dictionary is not saved.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with two keys, <code>problem</code> and <code>sobol_indices</code>, and their corresponding values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pySWATPlus/sensitivity_analyzer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sobol_indices</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sim_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">df_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sim_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obs_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obs_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">indicators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">json_file</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Compute Sobol sensitivy indices for sample scenarios obtained using</span>
<span class="sd">    the [`simulation_by_sobol_sample`](https://swat-model.github.io/pySWATPlus/api/sensitivity_analyzer/#pySWATPlus.SensitivityAnalyzer.simulation_by_sobol_sample) method.</span>

<span class="sd">    The method returns a dictionary with two keys:</span>

<span class="sd">    - `problem`: The definition dictionary passed to Sobol sampling.</span>
<span class="sd">    - `sobol_indices`: A dictionary where each key is an indicator name and the corresponding value is the computed Sobol sensitivity indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        sim_file (str | pathlib.Path): Path to the `sensitivity_simulation.json` file produced by `simulation_by_sobol_sample`.</span>

<span class="sd">        df_name (str): Name of the `DataFrame` within `sensitivity_simulation.json` from which to compute scenario indicators.</span>

<span class="sd">        sim_col (str): Name of the column in `df_name` containing simulated values.</span>

<span class="sd">        obs_file (str | pathlib.Path): Path to the CSV file containing observed data. The file must include a</span>
<span class="sd">            `date` column (used to merge simulated and observed data) and use a comma as the separator.</span>

<span class="sd">        date_format (str): Date format of the `date` column in `obs_file`, used to parse `datetime.date` objects from date strings.</span>

<span class="sd">        obs_col (str): Name of the column in `obs_file` containing observed data. All negative and `None` observed values are removed before analysis.</span>

<span class="sd">        indicators (list[str]): List of indicators to compute Sobol indices. Available options:</span>

<span class="sd">            - `NSE`: Nash–Sutcliffe Efficiency</span>
<span class="sd">            - `KGE`: Kling–Gupta Efficiency</span>
<span class="sd">            - `MSE`: Mean Squared Error</span>
<span class="sd">            - `RMSE`: Root Mean Squared Error</span>
<span class="sd">            - `PBIAS`: Percent Bias</span>
<span class="sd">            - `MARE`: Mean Absolute Relative Error</span>

<span class="sd">        json_file (str | pathlib.Path, optional): Path to a JSON file for saving the output dictionary where each key is an indicator name</span>
<span class="sd">            and the corresponding value is the computed Sobol sensitivity indices. If `None` (default), the dictionary is not saved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with two keys, `problem` and `sobol_indices`, and their corresponding values.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Check input variables type</span>
    <span class="n">validators</span><span class="o">.</span><span class="n">_variable_origin_static_type</span><span class="p">(</span>
        <span class="n">vars_types</span><span class="o">=</span><span class="n">typing</span><span class="o">.</span><span class="n">get_type_hints</span><span class="p">(</span>
            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sobol_indices</span>
        <span class="p">),</span>
        <span class="n">vars_values</span><span class="o">=</span><span class="nb">locals</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># Problem and indicators</span>
    <span class="n">prob_inct</span> <span class="o">=</span> <span class="n">PerformanceMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">scenario_indicators</span><span class="p">(</span>
        <span class="n">sim_file</span><span class="o">=</span><span class="n">sim_file</span><span class="p">,</span>
        <span class="n">df_name</span><span class="o">=</span><span class="n">df_name</span><span class="p">,</span>
        <span class="n">sim_col</span><span class="o">=</span><span class="n">sim_col</span><span class="p">,</span>
        <span class="n">obs_file</span><span class="o">=</span><span class="n">obs_file</span><span class="p">,</span>
        <span class="n">date_format</span><span class="o">=</span><span class="n">date_format</span><span class="p">,</span>
        <span class="n">obs_col</span><span class="o">=</span><span class="n">obs_col</span><span class="p">,</span>
        <span class="n">indicators</span><span class="o">=</span><span class="n">indicators</span>
    <span class="p">)</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">prob_inct</span><span class="p">[</span><span class="s1">&#39;problem&#39;</span><span class="p">]</span>
    <span class="n">indicator_df</span> <span class="o">=</span> <span class="n">prob_inct</span><span class="p">[</span><span class="s1">&#39;indicator&#39;</span><span class="p">]</span>

    <span class="c1"># Sobol sensitivity indices</span>
    <span class="n">sobol_indices</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="p">:</span>
        <span class="c1"># Indicator sensitivity indices</span>
        <span class="n">indicator_sensitivity</span> <span class="o">=</span> <span class="n">SALib</span><span class="o">.</span><span class="n">analyze</span><span class="o">.</span><span class="n">sobol</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span>
            <span class="n">problem</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">problem</span><span class="p">),</span>
            <span class="n">Y</span><span class="o">=</span><span class="n">indicator_df</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">)</span>
        <span class="n">sobol_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span> <span class="o">=</span> <span class="n">indicator_sensitivity</span>

    <span class="c1"># Save the Sobol indices</span>
    <span class="k">if</span> <span class="n">json_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Raise error for invalid JSON file extension</span>
        <span class="n">json_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="n">validators</span><span class="o">.</span><span class="n">_json_extension</span><span class="p">(</span>
            <span class="n">json_file</span><span class="o">=</span><span class="n">json_file</span>
        <span class="p">)</span>
        <span class="c1"># Modify sensitivity index to write in the JSON file</span>
        <span class="n">copy_indices</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sobol_indices</span><span class="p">)</span>
        <span class="n">write_indices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="p">:</span>
            <span class="n">write_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">copy_indices</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="c1"># saving output data</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_json</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">write_indices</span><span class="p">,</span> <span class="n">output_json</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Output dictionary</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;problem&#39;</span><span class="p">:</span> <span class="n">problem</span><span class="p">,</span>
        <span class="s1">&#39;sobol_indices&#39;</span><span class="p">:</span> <span class="n">sobol_indices</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>